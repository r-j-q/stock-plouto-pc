var Airwallex=function(e){"use strict";var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},t(e,n)};function n(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}var o=function(){return o=Object.assign||function(e){for(var t,n=1,o=arguments.length;n<o;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},o.apply(this,arguments)};function i(e,t){var n={};for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&t.indexOf(o)<0&&(n[o]=e[o]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(o=Object.getOwnPropertySymbols(e);i<o.length;i++)t.indexOf(o[i])<0&&Object.prototype.propertyIsEnumerable.call(e,o[i])&&(n[o[i]]=e[o[i]])}return n}function a(e,t,n,o){return new(n||(n=Promise))((function(i,a){function r(e){try{d(o.next(e))}catch(e){a(e)}}function l(e){try{d(o.throw(e))}catch(e){a(e)}}function d(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(r,l)}d((o=o.apply(e,t||[])).next())}))}function r(e,t){var n,o,i,a,r={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return a={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function l(l){return function(d){return function(l){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,l[0]&&(r=0)),r;)try{if(n=1,o&&(i=2&l[0]?o.return:l[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,l[1])).done)return i;switch(o=0,i&&(l=[2&l[0],i.value]),l[0]){case 0:case 1:i=l;break;case 4:return r.label++,{value:l[1],done:!1};case 5:r.label++,o=l[1],l=[0];continue;case 7:l=r.ops.pop(),r.trys.pop();continue;default:if(!((i=(i=r.trys).length>0&&i[i.length-1])||6!==l[0]&&2!==l[0])){r=0;continue}if(3===l[0]&&(!i||l[1]>i[0]&&l[1]<i[3])){r.label=l[1];break}if(6===l[0]&&r.label<i[1]){r.label=i[1],i=l;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(l);break}i[2]&&r.ops.pop(),r.trys.pop();continue}l=t.call(e,r)}catch(e){l=[6,e],o=0}finally{n=i=0}if(5&l[0])throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}([l,d])}}}function l(e,t,n){if(n||2===arguments.length)for(var o,i=0,a=t.length;i<a;i++)!o&&i in t||(o||(o=Array.prototype.slice.call(t,0,i)),o[i]=t[i]);return e.concat(o||Array.prototype.slice.call(t))}var d,s,c,u,v,p,m,f,h,y,w,g,b,E={version:"v1.330.2"},C={prod:"checkout.airwallex.com",demo:"checkout-demo.airwallex.com",staging:"checkout-staging.airwallex.com",qa:"checkoutui.qa.awx.im",preview:"checkoutui.preview.awx.im",dev:"localhost:3000"},S={prod:"https://pci-api.airwallex.com",demo:"https://pci-api-demo.airwallex.com",staging:"https://pci-api-staging.airwallex.com",qa:"https://pci-api-qa.airwallex.com",preview:"https://pci-api-preview.airwallex.com",dev:"https://localhost:8080"},I=function(e){return"https://".concat(C[e]||"checkout.airwallex.com")},A=function(){var e;"function"==typeof(null===(e=window.performance)||void 0===e?void 0:e.mark)&&window.performance.mark("awx-start-mount-element")},x="AIR_ANALYTICS_DEVICE_ID",U=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){var t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)}))},P={appName:"pa_checkout_web_SDK",deviceId:function(){try{var e=window.localStorage.getItem(x);return e||(e=U(),window.localStorage.setItem(x,e)),e}catch(e){return"deviceId"}}(),sessionId:U(),appVersion:null==E?void 0:E.version,platform:(c=window.navigator.userAgent,u=(null===(s=null===(d=window.navigator)||void 0===d?void 0:d.userAgentData)||void 0===s?void 0:s.platform)||window.navigator.platform,v="other",-1!==["Macintosh","MacIntel","MacPPC","Mac68K"].indexOf(u)?v="macos":-1!==["iPhone","iPad","iPod"].indexOf(u)?v="ios":-1!==["Win32","Win64","Windows","WinCE"].indexOf(u)?v="windows":/Android/.test(c)?v="android":/Linux/.test(u)&&(v="linux"),v)},R="callingFunction",_=function(e){var t,n,o,i,a,r=e.elementType,l=e.elementMountStatus,d=e.env;if("function"==typeof(null===(t=window.performance)||void 0===t?void 0:t.mark)&&"function"==typeof(null===(n=window.performance)||void 0===n?void 0:n.measure)){window.performance.mark("awx-end-mount-element"),window.performance.measure("awx-mount-element-performance","awx-start-mount-element","awx-end-mount-element");var s=null!==(a=null===(i=null===(o=window.performance.getEntriesByName("awx-mount-element-performance"))||void 0===o?void 0:o[0])||void 0===i?void 0:i.duration)&&void 0!==a?a:"unknown";M({env:d,eventName:"onReportAwxElementMountDuration",severity:"info",elementType:r,elementMountStatus:l,duration:s,origin:window.location.origin})}},M=function(e){var t=e.env||"staging";try{var n="https://api".concat("prod"===t?"":"-".concat(t),".airwallex.com/papluginlogs/logs"),i={commonData:o(o({},P),{env:t}),data:[o({severity:"info",origin:window.location.origin},e)]},a=new Blob([JSON.stringify(i)],{type:"text/plain; charset=UTF-8"});window.navigator.sendBeacon(n,a)}catch(e){console.log(e)}},T=function(){function e(e,t){var n,o,i,a,r,l=this;this.domElement=null,this.gatewayUrl=e,this.env=null!==(o=null===(n=this.gatewayUrl.match(/^https:\/\/checkout-?(staging|demo)\.airwallex\.com/))||void 0===n?void 0:n[1])&&void 0!==o?o:"prod",this.options=t,this.iframe=window.document.createElement("iframe"),this.iframe.setAttribute("frameborder","0"),this.iframe.setAttribute("allowtransparency","true"),this.iframe.setAttribute("importance","high"),this.iframe.setAttribute("scrolling","no"),this.iframe.setAttribute("allowpaymentrequest","true"),null===(i=this.iframe)||void 0===i||i.setAttribute("style","\n        transition: height 0.35s ease 0s;\n        height: 0;\n        width: 100%;\n        display: block;\n      "),null===(a=this.iframe)||void 0===a||a.addEventListener("error",(function(){l.elementMountStatus||(l.elementMountStatus="ERROR",_({elementType:l.elementType,elementMountStatus:"ERROR",env:l.env}))})),window.setTimeout((function(){l.elementMountStatus||(l.elementMountStatus="TIMEOUT",_({elementType:l.elementType,elementMountStatus:"TIMEOUT",env:l.env}))}),6e4),r=function(e){var t,n,o,i;if(e.origin===l.gatewayUrl&&e.isTrusted&&"onReady"===(null===(t=e.data)||void 0===t?void 0:t.code)){(null===(n=e.data)||void 0===n?void 0:n.type)!==l.elementType||l.elementMountStatus||(l.elementMountStatus="SUCCESS",_({elementType:l.elementType,elementMountStatus:"SUCCESS",env:l.env}));var a=new CustomEvent(null===(o=e.data)||void 0===o?void 0:o.code,{detail:{type:null===(i=e.data)||void 0===i?void 0:i.type},bubbles:!0,composed:!0});window.document.dispatchEvent(a)}},window.addEventListener("message",(function(e){window.ReactNativeWebView&&window.ReactNativeWebView.postMessage(JSON.stringify(e.data)),r(e)}))}return e.prototype.addResizeListener=function(e){var t=this;window.addEventListener("message",(function(n){var o,i,a,r;if(n.origin===t.gatewayUrl&&n.isTrusted&&"onResize"===(null===(o=n.data)||void 0===o?void 0:o.code)&&e===(null===(i=n.data)||void 0===i?void 0:i.type)){var l=null===(a=t.iframe)||void 0===a?void 0:a.style;l&&(l.height="".concat(null===(r=n.data)||void 0===r?void 0:r.height,"px"))}}))},e.prototype.mount=function(e){if("string"!=typeof e)return(null==e?void 0:e.hasChildNodes())&&(e.innerHTML=""),this.iframe&&(e.appendChild(this.iframe),A()),this.domElement=e,e;var t=window.document.getElementById(e);return(null==t?void 0:t.hasChildNodes())&&(t.innerHTML=""),this.iframe&&(null==t||t.appendChild(this.iframe),A()),t&&(this.domElement=t),t},e.prototype.blur=function(){var e,t;null===(t=null===(e=this.iframe)||void 0===e?void 0:e.contentWindow)||void 0===t||t.postMessage({code:"blur"},this.gatewayUrl)},e.prototype.clear=function(){var e,t;null===(t=null===(e=this.iframe)||void 0===e?void 0:e.contentWindow)||void 0===t||t.postMessage({code:"clear"},this.gatewayUrl)},e.prototype.destroy=function(){var e;this.clear(),null===(e=this.iframe)||void 0===e||e.remove(),this.iframe=null},e.prototype.focus=function(){var e,t;null===(t=null===(e=this.iframe)||void 0===e?void 0:e.contentWindow)||void 0===t||t.postMessage({code:"focus"},this.gatewayUrl)},e.prototype.pressArrowKey=function(e,t){var n,o=new CustomEvent("onPressArrowKey",{detail:{type:e,arrowKey:t},bubbles:!0,composed:!0});null===(n=this.domElement)||void 0===n||n.dispatchEvent(o)},e.prototype.unmount=function(){var e;this.clear(),this.iframe&&(null===(e=this.domElement)||void 0===e||e.removeChild(this.iframe))},e.prototype.update=function(e){var t,n;this.options=o(o({},this.options),e),null===(n=null===(t=this.iframe)||void 0===t?void 0:t.contentWindow)||void 0===n||n.postMessage({code:"update",options:e},this.gatewayUrl)},e.prototype.confirm=function(){return a(this,void 0,void 0,(function(){return r(this,(function(e){throw new Error("Confirm is not supported in ElementBase")}))}))},e.prototype.success=function(e,t){throw new Error("Call success with ".concat(e.id||(null==t?void 0:t.id)," is not supported in ElementBase"))},e.prototype.fail=function(e){throw new Error("Call fail with ".concat(e.code,": ").concat(e.message," is not supported in ElementBase"))},e}(),k=function(){try{return"ApplePaySession"in window&&(null===ApplePaySession||void 0===ApplePaySession?void 0:ApplePaySession.supportsVersion(4))&&(null===ApplePaySession||void 0===ApplePaySession?void 0:ApplePaySession.canMakePayments())}catch(e){console.error("ApplePaySession is not supported in iframe")}},j="applePayButton",L=function(e){function t(t,n,i){var l,d,s,c,u,v=this;return(v=e.call(this,t,i)||this).session=void 0,v.elementType=j,k()?(null===(l=v.iframe)||void 0===l||l.setAttribute("src","".concat(t,"/#/elements/apple-pay?options=").concat(encodeURIComponent(JSON.stringify(o(o({},v.options),{sessionId:n,fonts:null===(d=Be.options)||void 0===d?void 0:d.fonts}))),"&lang=").concat(null===(s=Be.options)||void 0===s?void 0:s.locale)),null===(c=v.iframe)||void 0===c||c.setAttribute("name","Airwallex apple pay button iframe"),null===(u=v.iframe)||void 0===u||u.setAttribute("title","Airwallex apple pay button iframe")):(console.warn("apple pay not support this device"),setTimeout((function(){v.ready()}),0)),v.addResizeListener(j),v.listenerFunc=function(e){var t,n,o,i,l,d,s,c;try{if(e.origin===v.gatewayUrl&&e.isTrusted&&(null===(t=e.data)||void 0===t?void 0:t.type)===j)switch(null===(n=e.data)||void 0===n?void 0:n.code){case"onReady":v.ready();break;case"onApplePayButtonClick":v.session||(v.session=new ApplePaySession(4,e.data.res)),v.click(),v.session.begin(),v.session.onvalidatemerchant=function(e){return a(v,void 0,void 0,(function(){var t,n,o;return r(this,(function(i){return t=e.validationURL,null===(o=null===(n=this.iframe)||void 0===n?void 0:n.contentWindow)||void 0===o||o.postMessage({code:"onApplePaySessionUpdate",name:"onvalidatemerchant",validationURL:t},this.gatewayUrl),[2]}))}))},v.session.onpaymentauthorized=function(e){var t,n;null===(n=null===(t=v.iframe)||void 0===t?void 0:t.contentWindow)||void 0===n||n.postMessage({code:"onApplePaySessionUpdate",name:"onpaymentauthorized",token:e.payment.token,billingContact:e.payment.billingContact},v.gatewayUrl)},v.session.oncancel=function(e){v.session=void 0,v.cancel(e)};break;case"onApplePayValidateSuccess":null===(o=v.session)||void 0===o||o.completeMerchantValidation(e.data.res);break;case"onSuccess":var u={status:ApplePaySession.STATUS_SUCCESS};null===(i=v.session)||void 0===i||i.completePayment(u),v.success(null===(l=e.data)||void 0===l?void 0:l.intent,null===(d=e.data)||void 0===d?void 0:d.consent);break;case"onError":u={status:ApplePaySession.STATUS_FAILURE},null===(s=v.session)||void 0===s||s.completePayment(u),v.fail(null===(c=e.data)||void 0===c?void 0:c.error)}}catch(e){v.session=void 0,console.error(e)}},window.addEventListener("popstate",(function(){window.removeEventListener("message",v.listenerFunc)})),window.addEventListener("message",v.listenerFunc),v}return n(t,e),t.prototype.ready=function(){var e,t=new CustomEvent("onReady",{detail:{type:j},bubbles:!0,composed:!0});null===(e=this.domElement)||void 0===e||e.dispatchEvent(t)},t.prototype.click=function(){var e,t=new CustomEvent("onClick",{detail:{type:j},bubbles:!0,composed:!0});null===(e=this.domElement)||void 0===e||e.dispatchEvent(t)},t.prototype.cancel=function(e){var t,n=new CustomEvent("onCancel",{detail:{type:j,event:e},bubbles:!0,composed:!0});null===(t=this.domElement)||void 0===t||t.dispatchEvent(n)},t.prototype.success=function(e,t){var n,o=new CustomEvent("onSuccess",{detail:{type:j,intent:e,consent:t},bubbles:!0,composed:!0});null===(n=this.domElement)||void 0===n||n.dispatchEvent(o)},t.prototype.fail=function(e){var t,n=new CustomEvent("onError",{detail:{type:j,error:e},bubbles:!0,composed:!0});null===(t=this.domElement)||void 0===t||t.dispatchEvent(n)},t.prototype.destroy=function(){e.prototype.destroy.call(this),window.removeEventListener("message",this.listenerFunc)},t}(T),W=function(e){function t(t,n,o){var i,a,r,l,d=this;return(d=e.call(this,t,o)||this).confirmResponse=n,null===(i=d.iframe)||void 0===i||i.setAttribute("src","".concat(t,"/#/elements/3ds-frictionless?options=").concat(encodeURIComponent(JSON.stringify(d.options)),"&lang=").concat(null===(a=Be.options)||void 0===a?void 0:a.locale)),null===(r=d.iframe)||void 0===r||r.setAttribute("name","Airwallex 3DS frictionless iframe"),null===(l=d.iframe)||void 0===l||l.setAttribute("title","Airwallex 3DS frictionless iframe"),window.addEventListener("message",(function(e){var t,n,o,i;e.origin===d.gatewayUrl&&e.isTrusted&&"onReady"===(null===(t=e.data)||void 0===t?void 0:t.code)&&"threeDsFrictionless"===(null===(n=e.data)||void 0===n?void 0:n.type)&&(null===(i=null===(o=d.iframe)||void 0===o?void 0:o.contentWindow)||void 0===i||i.postMessage({code:"update",data:d.confirmResponse},d.gatewayUrl))})),d}return n(t,e),t.prototype.confirm=function(){var e,t;return a(this,void 0,void 0,(function(){return r(this,(function(n){return null===(t=null===(e=this.iframe)||void 0===e?void 0:e.contentWindow)||void 0===t||t.postMessage({code:"confirm",data:this.confirmResponse},this.gatewayUrl),[2,null]}))}))},t}(T),N=function(e){function t(t,n,o){var i,a,r,l,d,s,c=this;return(c=e.call(this,t,o)||this).confirmResponse=n,null===(i=c.iframe)||void 0===i||i.setAttribute("src","".concat(t,"/#/elements/3ds-challenge?options=").concat(encodeURIComponent(JSON.stringify(c.options)))),null===(a=c.iframe)||void 0===a||a.setAttribute("name","Airwallex 3DS challenge iframe"),null===(r=c.iframe)||void 0===r||r.setAttribute("title","Airwallex 3DS challenge iframe"),null===(l=c.iframe)||void 0===l||l.setAttribute("scrolling","yes"),K({challengeWindowSize:null==o?void 0:o.customizeChallengeWindowSize,style:{popupWidth:null===(d=null==o?void 0:o.style)||void 0===d?void 0:d.popupWidth,popupHeight:null===(s=null==o?void 0:o.style)||void 0===s?void 0:s.popupHeight},useDefaultStyle:null==o?void 0:o.useDefaultStyle,iframe:c.iframe}),window.addEventListener("message",(function(e){var t,n,o,i;e.origin===c.gatewayUrl&&e.isTrusted&&"onReady"===(null===(t=e.data)||void 0===t?void 0:t.code)&&"threeDsChallenge"===(null===(n=e.data)||void 0===n?void 0:n.type)&&(null===(i=null===(o=c.iframe)||void 0===o?void 0:o.contentWindow)||void 0===i||i.postMessage({code:"update",data:c.confirmResponse},c.gatewayUrl))})),c}return n(t,e),t.prototype.confirm=function(){var e,t;return a(this,void 0,void 0,(function(){return r(this,(function(n){return null===(t=null===(e=this.iframe)||void 0===e?void 0:e.contentWindow)||void 0===t||t.postMessage({code:"confirm",data:this.confirmResponse},this.gatewayUrl),[2,null]}))}))},t}(T),O="",F=function(e){var t,n,o,i,a=e.orderSessionId,r=e.env,l=e.overrideScript,d=void 0===l||l;switch(r){case"prod":i="";break;case"preview":i="-staging";break;case"qa":i="-dev";break;default:i="-".concat(r)}var s="airwallex-fraud-api",c=null!==document.getElementById(s),u="https://static".concat(i,".airwallex.com/webapp/fraud/device-fingerprint/index.js?sessionId=").concat(a,"&hasScriptId=").concat(c,"&disable3rdTracking=").concat(!1),v=document.createElement("script");if(M({env:r,eventName:R,method:"injectDeviceFingerprintJS",hasScriptId:c,jsUrl:u,orderSessionId:a}),c){if(!d)return;null===(t=document.getElementById(s))||void 0===t||t.remove(),null===(n=document.getElementById("sig-api"))||void 0===n||n.remove()}v.setAttribute("id",s),v.setAttribute("data-order-session-id",a),v.addEventListener("load",(function(){M({env:r,eventName:R,method:"injectDeviceFingerprintJS - load",hasScriptId:c,jsUrl:u,orderSessionId:a})})),v.addEventListener("error",(function(){M({env:r,eventName:R,method:"injectDeviceFingerprintJS - error",hasScriptId:c,jsUrl:u,orderSessionId:a})})),v.src=u,null===(o=null===document||void 0===document?void 0:document.head)||void 0===o||o.appendChild(v)},D=function(e){var t,n=e.intent_id,i=void 0===n?"":n,a=e.env,r=e.overrideScript,l=void 0===r||r;return M({eventName:R,method:"getDeviceFingerprint",intent_id:i,env:a}),t={sessionId:O=i},P=o(o({},P),t),a&&F({orderSessionId:O,env:a,overrideScript:l}),O},B={"01":["250px","400px"],"02":["390px","400px"],"03":["500px","600px"],"04":["600px","400px"],"05":["100%","100%"]},q="\n  position: fixed;\n  top: 0;\n  left: 0;\n  width: 100%;\n  height: 0%;\n  z-index: 1500;\n  overflow: hidden;\n  background: rgba(84, 84, 94, 0.3);\n",z="threeDsFrictionless",H="threeDsChallenge",J=null,V={resolver:null,reject:null,awaiting:!1},K=function(e){var t=e.challengeWindowSize,n=e.style,o=e.useDefaultStyle,i=void 0===o||o,a=e.iframe,r=t&&B[t]?B[t]:B["05"],l=(null==n?void 0:n.popupWidth)?"".concat(null==n?void 0:n.popupWidth,"px"):r[0],d=(null==n?void 0:n.popupHeight)?"".concat(null==n?void 0:n.popupHeight,"px"):r[1];a.setAttribute("style","\n    background: white;\n    width: ".concat(l,";\n    height: ").concat(d,";\n    position: ").concat(i?"absolute":"relative",";\n    top: ").concat(i?"50%":"0",";\n    left: ").concat(i?"50%":"0",";\n    transform: ").concat(i?"translate(-50%, -50%)":"none",";\n    border-radius: ").concat(i?"4px":"0",";\n    "))},G=function(){J&&(J.remove(),J=null)},Y=function(e){var t;null===(t=document.querySelector("#".concat(e)))||void 0===t||t.remove(),ze(e===z?z:H)},Q=function(){V.awaiting=!1,V.resolver=null,V.reject=null},X=function(e){var t,n,o="data"in e?e.data:e.detail,i=["hpp","api"].includes(f),a=i?null:He(f),r=(null==a?void 0:a.gatewayUrl)||window.location.origin;("data"in e&&e.origin===r&&e.isTrusted||i)&&(null==o?void 0:o.type)===H&&("onReady"===(null==o?void 0:o.code)&&(console.log("challengeHandler onReady",(new Date).toLocaleTimeString()),setTimeout((function(){G(),p.style.height="100%"}),2e3)),"onChallengeSuccess"===(null==o?void 0:o.code)&&(p.style.height="0"),"onSuccess"===(null==o?void 0:o.code)&&(console.log("challengeHandler onSuccess",(new Date).toLocaleTimeString()),null===(t=V.resolver)||void 0===t||t.call(V,o),Q(),Y(H)),["onError","onChallengeError"].includes(null==o?void 0:o.code)&&(console.log("challengeHandler ".concat(null==o?void 0:o.code),(new Date).toLocaleTimeString()),null===(n=V.reject)||void 0===n||n.call(V,o.error),Q(),Y(H)))},Z=function(e){var t;Y(z),m?p=m:((p=document.createElement("div")).setAttribute("id",H),p.setAttribute("style",q),document.body.appendChild(p)),Je(H,new N(g,e,{origin:window.location.origin,style:{popupWidth:h,popupHeight:y},useDefaultStyle:null===m,customizeChallengeWindowSize:w,intent:b})),window.addEventListener("message",X),null===(t=He(H))||void 0===t||t.mount(p)},$=function(e){var t,n,o="data"in e?e.data:e.detail,i=["hpp","api"].includes(f),a=i?null:He(f),r=(null==a?void 0:a.gatewayUrl)||window.location.origin;("data"in e&&e.origin===r&&e.isTrusted||i)&&(null==o?void 0:o.type)===z&&(Y(H),"onSuccess"===(null==o?void 0:o.code)&&(console.log("frictionlessHandler onSuccess",(new Date).toLocaleTimeString()),G(),null===(t=V.resolver)||void 0===t||t.call(V,o),Q(),Y(z)),["onError","onChallengeError"].includes(null==o?void 0:o.code)&&(console.log("frictionlessHandler ".concat(null==o?void 0:o.code),(new Date).toLocaleTimeString()),null===(n=V.reject)||void 0===n||n.call(V,o.error),Q(),Y(z),G()),"onChallenge"===(null==o?void 0:o.code)&&(console.log("frictionlessHandler onChallenge threeDsFrictionlessType",(new Date).toLocaleTimeString()),Z(o)))},ee=function(e){var t,n=e.intent,o=e.gatewayUrl,i=e.next_action,a=e.authFormContainer,r=e.componentType,l=e.challengeWindowSize,d=e.lang;if(console.log("threeDsHandler onChallenge type",(new Date).toLocaleTimeString()),m=document.getElementById(a||""),f=r,w=l,g=o,b=n,Y(z),Y(H),function(e){var t=e.gatewayUrl,n=e.challengeWindowSize,o=e.style,i=e.lang;if(!J){var a=null===m,r=document.createElement("iframe");r.setAttribute("src","".concat(t,"/#/elements/loading?lang=").concat(i)),r.setAttribute("frameborder","0"),K({challengeWindowSize:n,style:o,useDefaultStyle:a,iframe:r}),(J=document.createElement("div")).setAttribute("id","threeDsLoading"),J.setAttribute("style",q),J.style.height="100%",J.appendChild(r),document.body.appendChild(J)}}({gatewayUrl:o,challengeWindowSize:l,lang:d,style:{popupWidth:h,popupHeight:y}}),"WAITING_USER_INFO_INPUT"===(null==i?void 0:i.stage))Z({type:"threeDsFrictionless",next_action:i});else{Je(z,new W(g,{code:"",type:z,next_action:i},{intent:b,origin:window.location.origin}));var s=document.createElement("div");s.setAttribute("id",z),document.body.appendChild(s),window.addEventListener("message",$),null===(t=He(z))||void 0===t||t.mount(s)}return new Promise((function(e,t){V.resolver=e,V.reject=t,V.awaiting=!0}))},te=function(e){var t=e.type,n=e.popupWidth,o=e.popupHeight,i=e.authFormContainer,l=e.lang;h=n,y=o;var d=function(e){return a(void 0,void 0,void 0,(function(){var n,o,a,s,c,u,v,p,m,f,h,y;return r(this,(function(r){switch(r.label){case 0:if(n="data"in e?e.data:e.detail,a=(o="hpp"===t)?null:He(t),s=(null==a?void 0:a.gatewayUrl)||window.location.origin,!("data"in e&&e.origin===s&&e.isTrusted||o)||(null==n?void 0:n.type)!==t||"onChallenge"!==(null==n?void 0:n.code))return[3,4];c=n.next_action,u=n.intent,r.label=1;case 1:return r.trys.push([1,3,,4]),[4,ee({gatewayUrl:s,intent:u,next_action:c,authFormContainer:i,componentType:t,lang:l})];case 2:return v=r.sent(),"hpp"===t?(w=new CustomEvent("on3dsSuccess",{detail:v,bubbles:!0,composed:!0}),window.document.dispatchEvent(w)):((null==v?void 0:v.intent)&&(null==a||a.success(null==v?void 0:v.intent)),null===(f=null===(m=null==a?void 0:a.iframe)||void 0===m?void 0:m.contentWindow)||void 0===f||f.postMessage({code:"on3dsSuccess",confirmResult:v},s)),window.removeEventListener("message",d),window.removeEventListener("message",$),window.removeEventListener("message",X),[3,4];case 3:return p=r.sent(),"hpp"===t?function(e){var t=new CustomEvent("on3dsError",{detail:{error:e},bubbles:!0,composed:!0});window.document.dispatchEvent(t)}(p):(p&&(null==a||a.fail(p)),null===(y=null===(h=null==a?void 0:a.iframe)||void 0===h?void 0:h.contentWindow)||void 0===y||y.postMessage({code:"on3dsError",error:p},s)),window.removeEventListener("message",X),[3,4];case 4:return[2]}var w}))}))};window.addEventListener("message",d)},ne="card",oe=function(e){var t=e.payment_consent_id,n=e.id,o=e.customer_id,i=e.currency,a=(e.latest_payment_attempt||{}).payment_method||{},r=a.id,l=a.card||{};return{intent_id:n,payment_consent_id:t||"",customer_id:o||"",currency:i||"",payment_method:{id:r||"",bin:l.bin,last4:l.last4,brand:l.brand}}},ie=function(e){function t(t,n,i){var a,r,l,d,s,c=this;return(c=e.call(this,t,i)||this).elementType=ne,c.confirmIntent={resolver:null,reject:null,awaiting:!1},c.paymentConsent={resolver:null,reject:null,awaiting:!1},null===(a=c.iframe)||void 0===a||a.setAttribute("src","".concat(t,"/#/elements/card?options=").concat(JSON.stringify(o(o({},c.options),{sessionId:n,fonts:null===(r=Be.options)||void 0===r?void 0:r.fonts})),"&lang=").concat(null===(l=Be.options)||void 0===l?void 0:l.locale)),null===(d=c.iframe)||void 0===d||d.setAttribute("name","Airwallex card element iframe"),null===(s=c.iframe)||void 0===s||s.setAttribute("title","Airwallex card element iframe"),c.addResizeListener(ne),window.addEventListener("message",(function(e){var t,n,o,a,r,l,d,s,u,v,p,m,f,h,y,w,g,b,E,C,S,I,A,x,U,P,R;if(e.origin===c.gatewayUrl&&e.isTrusted&&(null===(t=null==e?void 0:e.data)||void 0===t?void 0:t.type)===ne){if("onSubmit"===(null===(n=e.data)||void 0===n?void 0:n.code)){var _=new CustomEvent(null===(o=e.data)||void 0===o?void 0:o.code,{detail:{type:ne},bubbles:!0,composed:!0});window.document.dispatchEvent(_),null===(a=c.domElement)||void 0===a||a.dispatchEvent(_)}"onDynamicCurrencyConversion"===(null===(r=e.data)||void 0===r?void 0:r.code)&&(_=new CustomEvent(null===(l=e.data)||void 0===l?void 0:l.code,{detail:{type:ne},bubbles:!0,composed:!0}),window.document.dispatchEvent(_),null===(d=c.domElement)||void 0===d||d.dispatchEvent(_)),"onReady"===(null===(s=e.data)||void 0===s?void 0:s.code)&&(_=new CustomEvent(null===(u=e.data)||void 0===u?void 0:u.code,{detail:{type:ne},bubbles:!0,composed:!0}),null===(v=c.domElement)||void 0===v||v.dispatchEvent(_),te({type:ne,popupWidth:null===(p=null==i?void 0:i.style)||void 0===p?void 0:p.popupWidth,popupHeight:null===(m=null==i?void 0:i.style)||void 0===m?void 0:m.popupHeight,authFormContainer:null==i?void 0:i.authFormContainer,lang:null===(f=null==Be?void 0:Be.options)||void 0===f?void 0:f.locale})),"onSuccess"===(null===(h=e.data)||void 0===h?void 0:h.code)&&c.success(null===(y=e.data)||void 0===y?void 0:y.intent),"onError"===(null===(w=e.data)||void 0===w?void 0:w.code)&&c.fail(null===(g=e.data)||void 0===g?void 0:g.error),["onFocus","onBlur","onChange"].includes(null===(b=e.data)||void 0===b?void 0:b.code)&&(_=new CustomEvent(null===(E=e.data)||void 0===E?void 0:E.code,{detail:{type:ne,complete:null!==(S=null===(C=e.data)||void 0===C?void 0:C.complete)&&void 0!==S&&S,empty:null!==(A=null===(I=e.data)||void 0===I?void 0:I.empty)&&void 0!==A&&A,error:null===(x=e.data)||void 0===x?void 0:x.error,brand:null!==(P=null===(U=e.data)||void 0===U?void 0:U.brand)&&void 0!==P?P:""},bubbles:!0,composed:!0}),window.document.dispatchEvent(_),null===(R=c.domElement)||void 0===R||R.dispatchEvent(_))}})),c}return n(t,e),t.prototype.confirm=function(e){var t,n;return a(this,void 0,void 0,(function(){var a,l,d,s,c=this;return r(this,(function(r){return this.confirmIntent.awaiting&&console.warn("Should waiting previous confirm finished before execute new one!"),l=(a=e||{}).id,d=a.intent_id,s=i(a,["id","intent_id","element"]),null===(n=null===(t=this.iframe)||void 0===t?void 0:t.contentWindow)||void 0===n||n.postMessage({code:"confirm",data:o(o({},s),{id:l||d})},this.gatewayUrl),[2,new Promise((function(e,t){c.confirmIntent.resolver=e,c.confirmIntent.reject=t,c.confirmIntent.awaiting=!0}))]}))}))},t.prototype.createPaymentConsent=function(e){var t,n;return a(this,void 0,void 0,(function(){var a,l,d=this;return r(this,(function(r){return this.paymentConsent.awaiting&&console.warn("Should waiting previous createPaymentConsent finished before execute new one!"),a=e.intent_id,l=i(e,["element","intent_id"]),null===(n=null===(t=this.iframe)||void 0===t?void 0:t.contentWindow)||void 0===n||n.postMessage({code:"createPaymentConsent",data:o(o({},l),{intent_id:a})},this.gatewayUrl),[2,new Promise((function(e,t){d.paymentConsent.resolver=e,d.paymentConsent.reject=t,d.paymentConsent.awaiting=!0}))]}))}))},t.prototype.success=function(e){this.confirmIntent.awaiting&&this.confirmIntent.resolver&&this.confirmIntent.resolver(e),this.paymentConsent.awaiting&&this.paymentConsent.resolver&&this.paymentConsent.resolver(oe(e)),this.confirmIntent.awaiting=!1,this.paymentConsent.awaiting=!1},t.prototype.fail=function(e){this.confirmIntent.awaiting&&this.confirmIntent.reject&&this.confirmIntent.reject(e),this.paymentConsent.awaiting&&this.paymentConsent.reject&&this.paymentConsent.reject(e),this.confirmIntent={resolver:null,reject:null,awaiting:!1},this.paymentConsent={resolver:null,reject:null,awaiting:!1}},t}(T),ae="cardNumber",re=function(e){function t(t,n,i){var a,r,l,d,s,c=this;return(c=e.call(this,t,i)||this).elementType=ae,c.retrieve={resolver:null,reject:null,awaiting:!1},c.confirmIntent={resolver:null,reject:null,awaiting:!1},c.createMethod={resolver:null,reject:null,awaiting:!1},c.paymentConsent={resolver:null,reject:null,awaiting:!1},null===(a=c.iframe)||void 0===a||a.setAttribute("src","".concat(t,"/#/elements/card-number?options=").concat(encodeURIComponent(JSON.stringify(o(o({},c.options),{sessionId:n,fonts:null===(r=Be.options)||void 0===r?void 0:r.fonts}))),"&lang=").concat(null===(l=Be.options)||void 0===l?void 0:l.locale)),null===(d=c.iframe)||void 0===d||d.setAttribute("name","Airwallex card number element iframe"),null===(s=c.iframe)||void 0===s||s.setAttribute("title","Airwallex card number element iframe"),c.addResizeListener(ae),window.addEventListener("message",(function(e){var t,n,o,a,r,l,d,s,u,v,p,m,f,h,y,w,g,b,E,C,S,I,A,x,U,P,R,_,M,T,k,j,L,W,N,O,F,D;if(e.origin===c.gatewayUrl&&e.isTrusted&&(null===(t=null==e?void 0:e.data)||void 0===t?void 0:t.type)===ae){if("onSubmit"===(null===(n=e.data)||void 0===n?void 0:n.code)){var B=new CustomEvent(null===(o=e.data)||void 0===o?void 0:o.code,{detail:{type:ae},bubbles:!0,composed:!0});window.document.dispatchEvent(B),null===(a=c.domElement)||void 0===a||a.dispatchEvent(B)}"onDynamicCurrencyConversion"===(null===(r=e.data)||void 0===r?void 0:r.code)&&(B=new CustomEvent(null===(l=e.data)||void 0===l?void 0:l.code,{detail:{type:ae},bubbles:!0,composed:!0}),window.document.dispatchEvent(B),null===(d=c.domElement)||void 0===d||d.dispatchEvent(B)),"onReady"===(null===(s=e.data)||void 0===s?void 0:s.code)&&(B=new CustomEvent(null===(u=e.data)||void 0===u?void 0:u.code,{detail:{type:null===(v=e.data)||void 0===v?void 0:v.type},bubbles:!0,composed:!0}),null===(p=c.domElement)||void 0===p||p.dispatchEvent(B),te({type:ae,popupWidth:null===(m=null==i?void 0:i.style)||void 0===m?void 0:m.popupWidth,popupHeight:null===(f=null==i?void 0:i.style)||void 0===f?void 0:f.popupHeight,authFormContainer:null==i?void 0:i.authFormContainer,lang:null===(h=null==Be?void 0:Be.options)||void 0===h?void 0:h.locale})),"onSuccess"===(null===(y=e.data)||void 0===y?void 0:y.code)&&(c.confirmIntent.resolver||c.paymentConsent.resolver)&&c.success(null===(w=e.data)||void 0===w?void 0:w.intent),"onError"===(null===(g=e.data)||void 0===g?void 0:g.code)&&(c.confirmIntent.reject||c.paymentConsent.reject)&&c.fail(null===(b=e.data)||void 0===b?void 0:b.error),"onIntentRetrieved"===(null===(E=e.data)||void 0===E?void 0:E.code)&&c.retrieve.resolver&&c.success(null===(C=e.data)||void 0===C?void 0:C.intent),"onRetrieveIntentError"===(null===(S=e.data)||void 0===S?void 0:S.code)&&(c.fail(null===(I=e.data)||void 0===I?void 0:I.error),c.retrieve.awaiting=!1),"onPaymentMethodCreated"===(null===(A=e.data)||void 0===A?void 0:A.code)&&c.createMethod.resolver&&(c.createMethod.resolver(null===(x=e.data)||void 0===x?void 0:x.paymentMethod),c.createMethod.awaiting=!1),"onPaymentMethodCreatedError"===(null===(U=e.data)||void 0===U?void 0:U.code)&&c.fail(null===(P=e.data)||void 0===P?void 0:P.error),"onPressArrowKey"===(null===(R=e.data)||void 0===R?void 0:R.code)&&c.pressArrowKey(ae,null===(_=e.data)||void 0===_?void 0:_.arrowKey),["onFocus","onBlur","onChange"].includes(null===(M=e.data)||void 0===M?void 0:M.code)&&(B=new CustomEvent(null===(T=e.data)||void 0===T?void 0:T.code,{detail:{type:ae,complete:null!==(j=null===(k=e.data)||void 0===k?void 0:k.complete)&&void 0!==j&&j,empty:null!==(W=null===(L=e.data)||void 0===L?void 0:L.empty)&&void 0!==W&&W,error:null===(N=e.data)||void 0===N?void 0:N.error,brand:null!==(F=null===(O=e.data)||void 0===O?void 0:O.brand)&&void 0!==F?F:""},bubbles:!0,composed:!0}),window.document.dispatchEvent(B),null===(D=c.domElement)||void 0===D||D.dispatchEvent(B))}})),c}return n(t,e),t.prototype.confirm=function(e){var t,n;return a(this,void 0,void 0,(function(){var a,l,d,s,c=this;return r(this,(function(r){return this.confirmIntent.awaiting&&console.warn("Should waiting previous confirm finished before execute new one!"),l=(a=e||{}).id,d=a.intent_id,s=i(a,["id","intent_id","element"]),null===(n=null===(t=this.iframe)||void 0===t?void 0:t.contentWindow)||void 0===n||n.postMessage({code:"confirm",data:o(o({},s),{id:l||d})},this.gatewayUrl),[2,new Promise((function(e,t){c.confirmIntent.resolver=e,c.confirmIntent.reject=t,c.confirmIntent.awaiting=!0}))]}))}))},t.prototype.createPaymentMethod=function(e){var t,n;return a(this,void 0,void 0,(function(){var o,a=this;return r(this,(function(r){return this.createMethod.awaiting&&console.warn("Should waiting previous createPaymentMethod finished before execute new one!"),o=i(e||{},["element"]),null===(n=null===(t=this.iframe)||void 0===t?void 0:t.contentWindow)||void 0===n||n.postMessage({code:"createPaymentMethod",data:o},this.gatewayUrl),[2,new Promise((function(e,t){a.createMethod.resolver=e,a.createMethod.reject=t,a.createMethod.awaiting=!0}))]}))}))},t.prototype.createPaymentConsent=function(e){var t,n;return a(this,void 0,void 0,(function(){var a,l,d=this;return r(this,(function(r){return this.paymentConsent.awaiting&&console.warn("Should waiting previous createPaymentConsent finished before execute new one!"),a=e.intent_id,l=i(e,["element","intent_id"]),null===(n=null===(t=this.iframe)||void 0===t?void 0:t.contentWindow)||void 0===n||n.postMessage({code:"createPaymentConsent",data:o(o({},l),{intent_id:a})},this.gatewayUrl),[2,new Promise((function(e,t){d.paymentConsent.resolver=e,d.paymentConsent.reject=t,d.paymentConsent.awaiting=!0}))]}))}))},t.prototype.getPaymentIntent=function(e,t){var n,o;return a(this,void 0,void 0,(function(){var i=this;return r(this,(function(a){return this.retrieve.awaiting&&console.warn("Should waiting previous getPaymentIntent finished before execute new one!"),null===(o=null===(n=this.iframe)||void 0===n?void 0:n.contentWindow)||void 0===o||o.postMessage({code:"getIntent",data:{id:e,client_secret:t}},this.gatewayUrl),[2,new Promise((function(e,t){i.retrieve.resolver=e,i.retrieve.reject=t,i.retrieve.awaiting=!0}))]}))}))},t.prototype.success=function(e){this.confirmIntent.awaiting&&this.confirmIntent.resolver&&this.confirmIntent.resolver(e),this.retrieve.awaiting&&this.retrieve.resolver&&this.retrieve.resolver(e),this.paymentConsent.awaiting&&this.paymentConsent.resolver&&this.paymentConsent.resolver(oe(e)),this.confirmIntent.awaiting=!1,this.retrieve.awaiting=!1,this.paymentConsent.awaiting=!1},t.prototype.fail=function(e){this.confirmIntent.awaiting&&this.confirmIntent.reject&&this.confirmIntent.reject(e),this.retrieve.awaiting&&this.retrieve.reject&&this.retrieve.reject(e),this.createMethod.awaiting&&this.createMethod.reject&&this.createMethod.reject(e),this.paymentConsent.awaiting&&this.paymentConsent.reject&&this.paymentConsent.reject(e),this.retrieve={resolver:null,reject:null,awaiting:!1},this.confirmIntent={resolver:null,reject:null,awaiting:!1},this.createMethod={resolver:null,reject:null,awaiting:!1},this.paymentConsent={resolver:null,reject:null,awaiting:!1}},t}(T),le="expiry",de=function(e){function t(t,n,i){var a,r,l,d,s,c=this;return(c=e.call(this,t,i)||this).elementType=le,null===(a=c.iframe)||void 0===a||a.setAttribute("src","".concat(t,"/#/elements/expiry?options=").concat(encodeURIComponent(JSON.stringify(o(o({},c.options),{sessionId:n,fonts:null===(r=Be.options)||void 0===r?void 0:r.fonts}))),"&lang=").concat(null===(l=Be.options)||void 0===l?void 0:l.locale)),null===(d=c.iframe)||void 0===d||d.setAttribute("name","Airwallex expiry number element iframe"),null===(s=c.iframe)||void 0===s||s.setAttribute("title","Airwallex expiry number element iframe"),c.addResizeListener(le),window.addEventListener("message",(function(e){var t,n,o,i,a,r,l,d,s,u,v,p,m,f,h;if(e.origin===c.gatewayUrl&&e.isTrusted&&(null===(t=null==e?void 0:e.data)||void 0===t?void 0:t.type)===le){if("onReady"===(null===(n=e.data)||void 0===n?void 0:n.code)){var y=new CustomEvent(null===(o=e.data)||void 0===o?void 0:o.code,{detail:{type:null===(i=e.data)||void 0===i?void 0:i.type},bubbles:!0,composed:!0});null===(a=c.domElement)||void 0===a||a.dispatchEvent(y)}["onFocus","onBlur","onChange"].includes(null===(r=e.data)||void 0===r?void 0:r.code)&&(y=new CustomEvent(null===(l=e.data)||void 0===l?void 0:l.code,{detail:{type:le,complete:null!==(s=null===(d=e.data)||void 0===d?void 0:d.complete)&&void 0!==s&&s,empty:null!==(v=null===(u=e.data)||void 0===u?void 0:u.empty)&&void 0!==v&&v,error:null===(p=e.data)||void 0===p?void 0:p.error},bubbles:!0,composed:!0}),window.document.dispatchEvent(y),null===(m=c.domElement)||void 0===m||m.dispatchEvent(y)),"onPressArrowKey"===(null===(f=e.data)||void 0===f?void 0:f.code)&&c.pressArrowKey(le,null===(h=e.data)||void 0===h?void 0:h.arrowKey)}})),c}return n(t,e),t}(T),se="cvc",ce=function(e){function t(t,n,i){var a,r,l,d,s,c=this;return(c=e.call(this,t,i)||this).elementType=se,c.confirmIntent={resolver:null,reject:null,awaiting:!1},null===(a=c.iframe)||void 0===a||a.setAttribute("src","".concat(t,"/#/elements/cvc?options=").concat(encodeURIComponent(JSON.stringify(o(o({},c.options),{sessionId:n,fonts:null===(r=Be.options)||void 0===r?void 0:r.fonts}))),"&lang=").concat(null===(l=Be.options)||void 0===l?void 0:l.locale)),null===(d=c.iframe)||void 0===d||d.setAttribute("name","Airwallex cvc number element iframe"),null===(s=c.iframe)||void 0===s||s.setAttribute("title","Airwallex cvc number element iframe"),c.addResizeListener("cvc"),window.addEventListener("message",(function(e){var t,n,o,a,r,l,d,s,u,v,p,m,f,h,y,w,g,b,E,C,S,I,A,x,U,P,R,_,M,T,k,j;if(e.origin===c.gatewayUrl&&e.isTrusted&&(null===(t=null==e?void 0:e.data)||void 0===t?void 0:t.type)===se){if("onSubmit"===(null===(n=e.data)||void 0===n?void 0:n.code)){var L=new CustomEvent(null===(o=e.data)||void 0===o?void 0:o.code,{detail:{type:se},bubbles:!0,composed:!0});window.document.dispatchEvent(L),null===(a=c.domElement)||void 0===a||a.dispatchEvent(L)}"onDynamicCurrencyConversion"===(null===(r=e.data)||void 0===r?void 0:r.code)&&(L=new CustomEvent(null===(l=e.data)||void 0===l?void 0:l.code,{detail:{type:se},bubbles:!0,composed:!0}),window.document.dispatchEvent(L),null===(d=c.domElement)||void 0===d||d.dispatchEvent(L)),"onReady"===(null===(s=e.data)||void 0===s?void 0:s.code)&&(L=new CustomEvent(null===(u=e.data)||void 0===u?void 0:u.code,{detail:{type:null===(v=e.data)||void 0===v?void 0:v.type},bubbles:!0,composed:!0}),null===(p=c.domElement)||void 0===p||p.dispatchEvent(L),te({type:se,popupWidth:null===(m=null==i?void 0:i.style)||void 0===m?void 0:m.popupWidth,popupHeight:null===(f=null==i?void 0:i.style)||void 0===f?void 0:f.popupHeight,authFormContainer:null==i?void 0:i.authFormContainer,lang:null===(h=null==Be?void 0:Be.options)||void 0===h?void 0:h.locale})),"onSuccess"===(null===(y=e.data)||void 0===y?void 0:y.code)&&c.confirmIntent.resolver&&c.success(null===(w=e.data)||void 0===w?void 0:w.intent),"onError"===(null===(g=e.data)||void 0===g?void 0:g.code)&&c.confirmIntent.reject&&c.fail(null===(b=e.data)||void 0===b?void 0:b.error),["onFocus","onBlur","onChange"].includes(null===(E=e.data)||void 0===E?void 0:E.code)&&(L=new CustomEvent(null===(C=e.data)||void 0===C?void 0:C.code,{detail:{type:se,complete:null!==(I=null===(S=e.data)||void 0===S?void 0:S.complete)&&void 0!==I&&I,empty:null!==(x=null===(A=e.data)||void 0===A?void 0:A.empty)&&void 0!==x&&x,error:null===(U=e.data)||void 0===U?void 0:U.error},bubbles:!0,composed:!0}),window.document.dispatchEvent(L),null===(P=c.domElement)||void 0===P||P.dispatchEvent(L)),"onPressArrowKey"===(null===(R=e.data)||void 0===R?void 0:R.code)&&c.pressArrowKey(se,null===(_=e.data)||void 0===_?void 0:_.arrowKey)}e.origin===c.gatewayUrl&&e.isTrusted&&"cardNumber"===(null===(M=e.data)||void 0===M?void 0:M.type)&&"onChange"===(null===(T=e.data)||void 0===T?void 0:T.code)&&(null===(j=null===(k=c.iframe)||void 0===k?void 0:k.contentWindow)||void 0===j||j.postMessage({code:"update",options:{cvcLength:e.data.cvcLength}},c.gatewayUrl))})),c}return n(t,e),t.prototype.confirm=function(e){var t,n;return a(this,void 0,void 0,(function(){var a,l,d,s,c=this;return r(this,(function(r){return this.confirmIntent.awaiting&&console.warn("Should waiting previous confirm finished before execute new one!"),l=(a=e||{}).id,d=a.intent_id,s=i(a,["id","intent_id","element"]),null===(n=null===(t=this.iframe)||void 0===t?void 0:t.contentWindow)||void 0===n||n.postMessage({code:"confirm",data:o(o({},s),{id:l||d})},this.gatewayUrl),[2,new Promise((function(e,t){c.confirmIntent.resolver=e,c.confirmIntent.reject=t,c.confirmIntent.awaiting=!0}))]}))}))},t.prototype.success=function(e){this.confirmIntent.resolver&&this.confirmIntent.resolver(e),this.confirmIntent.awaiting=!1},t.prototype.fail=function(e){this.confirmIntent.awaiting&&this.confirmIntent.reject&&this.confirmIntent.reject(e),this.confirmIntent={resolver:null,reject:null,awaiting:!1}},t}(T),ue=function(e){function t(t,n,i){var a,r,l,d,s,c=this;return null===(a=(c=e.call(this,t,i)||this).iframe)||void 0===a||a.setAttribute("src","".concat(t,"/#/elements/payment-request-button?options=").concat(encodeURIComponent(JSON.stringify(o(o({},i),{sessionId:n,fonts:null===(r=Be.options)||void 0===r?void 0:r.fonts}))),"&lang=").concat(null===(l=Be.options)||void 0===l?void 0:l.locale)),null===(d=c.iframe)||void 0===d||d.setAttribute("name","Airwallex payment request element iframe"),null===(s=c.iframe)||void 0===s||s.setAttribute("title","Airwallex payment request element iframe"),c.addResizeListener("paymentRequestButton"),window.addEventListener("message",(function(e){var t,n,o,a,r,l,d,s,u,v,p,m;if(e.origin===c.gatewayUrl&&e.isTrusted&&"paymentRequestButton"===(null===(t=e.data)||void 0===t?void 0:t.type))if("onReady"===(null===(n=e.data)||void 0===n?void 0:n.code)){te({type:"paymentRequestButton",popupWidth:null===(o=null==i?void 0:i.style)||void 0===o?void 0:o.popupWidth,popupHeight:null===(a=null==i?void 0:i.style)||void 0===a?void 0:a.popupHeight,authFormContainer:null==i?void 0:i.authFormContainer,lang:null===(r=null==Be?void 0:Be.options)||void 0===r?void 0:r.locale});var f=new CustomEvent(null===(l=e.data)||void 0===l?void 0:l.code,{detail:{type:null===(d=e.data)||void 0===d?void 0:d.type},bubbles:!0,composed:!0});null===(s=c.domElement)||void 0===s||s.dispatchEvent(f)}else"onSuccess"===(null===(u=e.data)||void 0===u?void 0:u.code)?c.success(null===(v=e.data)||void 0===v?void 0:v.intent):"onError"===(null===(p=e.data)||void 0===p?void 0:p.code)&&c.fail(null===(m=e.data)||void 0===m?void 0:m.error)})),c}return n(t,e),t.prototype.success=function(e){var t=new CustomEvent("onSuccess",{detail:{type:"paymentRequestButton",intent:e},bubbles:!0,composed:!0});window.document.dispatchEvent(t)},t.prototype.fail=function(e){var t=new CustomEvent("onError",{detail:{type:"paymentRequestButton",error:e},bubbles:!0,composed:!0});window.document.dispatchEvent(t)},t}(T),ve=function(e){e.startsWith("http")?window.location.href=e:window.open(e)},pe=function(){function e(e){var t=e.width,n=void 0===t?"100%":t,o=e.height,i=void 0===o?"100%":o,a=e.borderRadius,r=void 0===a?"6px":a,d=e.repeatCount,s=void 0===d?1:d,c=e.margin,u=void 0===c?"":c,v=window.document.createElement("style");v.textContent="\n    @keyframes MuiSkeleton-keyframes-pulse {\n        0% {\n          opacity: 1;\n        }\n        50% {\n          opacity: 0.4;\n        }\n        100% {\n          opacity: 1;\n        }\n      }";var p=window.document.createElement("div");p.appendChild(v),p.setAttribute("id","loading"),l([],Array(s),!0).forEach((function(e,t){var o=window.document.createElement("div");o.setAttribute("style","width: ".concat(n,";\n         height:").concat(i,";\n         border-radius:").concat(r,";\n         margin:").concat(t===s-1?"":u,";\n         background-color:#EBECF0;\n         animation: MuiSkeleton-keyframes-pulse 1.5s ease-in-out 0.5s infinite;")),p.appendChild(o)})),this.domElement=p}return e.prototype.getDomElement=function(){return this.domElement},e}(),me=null,fe=function(e){return a(void 0,void 0,void 0,(function(){var t;return r(this,(function(n){return me?[2]:((t=document.createElement("iframe")).src="".concat(e,"/#/page/plaid-popup-iframe?origin=").concat(window.location.origin),t.id="airwallex-plaid-oauth",t.setAttribute("frameborder","0"),t.setAttribute("allowtransparency","true"),t.setAttribute("importance","high"),t.setAttribute("scrolling","no"),t.setAttribute("allowpaymentrequest","true"),t.setAttribute("style","\n    position: fixed;\n    left: 0;\n    top: 0;\n    width: 100vw;\n    height: 100vh;\n    display: none;\n    z-index: 10000;\n  "),document.body.appendChild(t),me=t,[2,new Promise((function(e){window.addEventListener("message",(function(t){var n,o;["https://checkout-staging.airwallex.com","https://checkout-demo.airwallex.com","https://checkout.airwallex.com"].includes(t.origin)&&"plaidPopupIframe"===(null===(n=t.data)||void 0===n?void 0:n.type)&&"onPlaidReady"===(null===(o=t.data)||void 0===o?void 0:o.code)&&e(!0)}))}))])}))}))},he=function(e){var t,n=e.data,o=e.origin;me&&(ye(),null===(t=me.contentWindow)||void 0===t||t.postMessage(n,o))},ye=function(){me&&(me.style.display="block")},we="dropIn",ge=function(e){function t(t,n,i){var l,d,s,c,u,v=this;(v=e.call(this,t,i)||this).elementType=we;var p=(i||{}).applePayRequestOptions;return k()?v.applePayRequestOptions=p:v.applePayRequestOptions=void 0,null===(l=v.iframe)||void 0===l||l.setAttribute("src","".concat(t,"/#/elements/dropin?options=").concat(encodeURIComponent(JSON.stringify(o(o({},i),{sessionId:n,applePayRequestOptions:v.applePayRequestOptions,fonts:null===(d=Be.options)||void 0===d?void 0:d.fonts}))),"&lang=").concat(null===(s=Be.options)||void 0===s?void 0:s.locale)),null===(c=v.iframe)||void 0===c||c.setAttribute("name","Airwallex dropIn element iframe"),null===(u=v.iframe)||void 0===u||u.setAttribute("title","Airwallex dropIn element iframe"),v.addResizeListener(we),v.iframe&&function(e){window.addEventListener("message",(function(t){var n,o;["https://checkout-staging.airwallex.com","https://checkout-demo.airwallex.com","https://checkout.airwallex.com"].includes(t.origin)&&"plaidPopupIframe"===(null===(n=t.data)||void 0===n?void 0:n.type)&&(me&&(me.style.display="none"),e&&(null===(o=e.contentWindow)||void 0===o||o.postMessage(t.data,t.origin)))}))}(v.iframe),v.listenerFunc=function(e){var t,n,o,l,d,s,c,u,p,m,f,h,y,w;try{if(e.origin===v.gatewayUrl&&e.isTrusted&&(null===(t=e.data)||void 0===t?void 0:t.type)===we)switch(null===(n=e.data)||void 0===n?void 0:n.code){case"onReady":te({type:we,popupWidth:null===(o=null==i?void 0:i.style)||void 0===o?void 0:o.popupWidth,popupHeight:null===(l=null==i?void 0:i.style)||void 0===l?void 0:l.popupHeight,authFormContainer:null==i?void 0:i.authFormContainer,lang:null===(d=null==Be?void 0:Be.options)||void 0===d?void 0:d.locale}),v.removeLoading(),v.ready();break;case"onRedirect":var g=(null!==(c=null===(s=e.data)||void 0===s?void 0:s.redirectPayload)&&void 0!==c?c:{}).redirectUrl;g&&ve(g);break;case"onSuccess":if(v.success(null===(u=e.data)||void 0===u?void 0:u.intent,null===(p=e.data)||void 0===p?void 0:p.consent),v.session){var b={status:ApplePaySession.STATUS_SUCCESS};null===(m=v.session)||void 0===m||m.completePayment(b)}break;case"onError":v.session&&(b={status:ApplePaySession.STATUS_FAILURE},null===(f=v.session)||void 0===f||f.completePayment(b)),v.fail(null===(h=e.data)||void 0===h?void 0:h.error);break;case"onPendingVerifyAccount":v.pendingVerifyAccount(e.data.intent,null===(y=e.data.directDebit)||void 0===y?void 0:y.url);break;case"onSwitchMethod":v.switchMethod({method:e.data.method,methodName:e.data.methodName,surchargeFee:e.data.surchargeFee});break;case"onApplePayButtonClick":v.session||(v.session=new ApplePaySession(4,e.data.res)),v.session.begin(),v.session.onvalidatemerchant=function(e){return a(v,void 0,void 0,(function(){var t,n,o;return r(this,(function(i){return t=e.validationURL,null===(o=null===(n=this.iframe)||void 0===n?void 0:n.contentWindow)||void 0===o||o.postMessage({code:"onApplePaySessionUpdate",name:"onvalidatemerchant",validationURL:t},this.gatewayUrl),[2]}))}))},v.session.onpaymentauthorized=function(e){var t,n;null===(n=null===(t=v.iframe)||void 0===t?void 0:t.contentWindow)||void 0===n||n.postMessage({code:"onApplePaySessionUpdate",name:"onpaymentauthorized",token:e.payment.token,billingContact:e.payment.billingContact},v.gatewayUrl)},v.session.oncancel=function(e){v.session=void 0,v.cancel(e)};break;case"onApplePayValidateSuccess":null===(w=v.session)||void 0===w||w.completeMerchantValidation(e.data.res);break;case"onCreatePlaidPopupIframe":fe(v.gatewayUrl);break;case"onPlaidStart":he({data:e.data,origin:v.gatewayUrl})}}catch(e){v.session=void 0,console.error(e)}},window.addEventListener("popstate",(function(){window.removeEventListener("message",v.listenerFunc)})),window.addEventListener("message",v.listenerFunc),v}return n(t,e),t.prototype.mount=function(e){var t=new pe({width:"100%",height:"42px",margin:"0px 0px 20px 0px",repeatCount:3}).getDomElement();if("string"!=typeof e)return(null==e?void 0:e.hasChildNodes())&&(e.innerHTML=""),e.append(t||"",this.iframe||""),A(),this.domElement=e,e;var n=window.document.getElementById(e);return(null==n?void 0:n.hasChildNodes())&&(n.innerHTML=""),null==n||n.append(t||"",this.iframe||""),A(),n&&(this.domElement=n),n},t.prototype.removeLoading=function(){var e,t=null===(e=this.domElement)||void 0===e?void 0:e.querySelector("#loading");this.domElement&&t&&t.remove()},t.prototype.ready=function(){var e,t=new CustomEvent("onReady",{detail:{type:we},bubbles:!0,composed:!0});window.document.dispatchEvent(t),null===(e=this.domElement)||void 0===e||e.dispatchEvent(t)},t.prototype.success=function(e,t){var n,o=new CustomEvent("onSuccess",{detail:{type:we,intent:e,consent:t},bubbles:!0,composed:!0});window.document.dispatchEvent(o),null===(n=this.domElement)||void 0===n||n.dispatchEvent(o)},t.prototype.fail=function(e){var t,n=new CustomEvent("onError",{detail:{type:we,error:e},bubbles:!0,composed:!0});window.document.dispatchEvent(n),null===(t=this.domElement)||void 0===t||t.dispatchEvent(n)},t.prototype.cancel=function(e){var t,n=new CustomEvent("onCancel",{detail:{type:we,event:e},bubbles:!0,composed:!0});window.document.dispatchEvent(n),null===(t=this.domElement)||void 0===t||t.dispatchEvent(n)},t.prototype.pendingVerifyAccount=function(e,t){var n,o=new CustomEvent("onPendingVerifyAccount",{detail:{type:we,intent:e,url:t},bubbles:!0,composed:!0});null===(n=this.domElement)||void 0===n||n.dispatchEvent(o),window.document.dispatchEvent(o)},t.prototype.switchMethod=function(e){var t,n=e.method,o=e.methodName,i=e.surchargeFee,a=new CustomEvent("onSwitchMethod",{detail:{type:we,method:n,methodName:o,surchargeFee:i},bubbles:!0,composed:!0});null===(t=this.domElement)||void 0===t||t.dispatchEvent(a)},t.prototype.destroy=function(){e.prototype.destroy.call(this),window.removeEventListener("message",this.listenerFunc)},t}(T),be="fullFeaturedCard",Ee=function(e){function t(t,n,i){var a,r,l,d,s,c=this;return(c=e.call(this,t,i)||this).elementType=be,null===(a=c.iframe)||void 0===a||a.setAttribute("src","".concat(t,"/#/elements/full-featured-card?options=").concat(encodeURIComponent(JSON.stringify(o(o({},i),{sessionId:n,fonts:null===(r=Be.options)||void 0===r?void 0:r.fonts}))),"&lang=").concat(null===(l=Be.options)||void 0===l?void 0:l.locale)),null===(d=c.iframe)||void 0===d||d.setAttribute("name","Airwallex full featured card element iframe"),null===(s=c.iframe)||void 0===s||s.setAttribute("title","Airwallex full featured card element iframe"),c.addResizeListener(be),window.addEventListener("message",(function(e){var t,n,o,a,r,l,d,s,u,v,p,m;if(e.origin===c.gatewayUrl&&e.isTrusted&&(null===(t=e.data)||void 0===t?void 0:t.type)===be)if("onReady"===(null===(n=e.data)||void 0===n?void 0:n.code)){te({type:be,popupWidth:null===(o=null==i?void 0:i.style)||void 0===o?void 0:o.popupWidth,popupHeight:null===(a=null==i?void 0:i.style)||void 0===a?void 0:a.popupHeight,authFormContainer:null==i?void 0:i.authFormContainer,lang:null===(r=null==Be?void 0:Be.options)||void 0===r?void 0:r.locale});var f=new CustomEvent(null===(l=e.data)||void 0===l?void 0:l.code,{detail:{type:null===(d=e.data)||void 0===d?void 0:d.type},bubbles:!0,composed:!0});null===(s=c.domElement)||void 0===s||s.dispatchEvent(f)}else"onSuccess"===(null===(u=e.data)||void 0===u?void 0:u.code)?c.success(null===(v=e.data)||void 0===v?void 0:v.intent):"onError"===(null===(p=e.data)||void 0===p?void 0:p.code)&&c.fail(null===(m=e.data)||void 0===m?void 0:m.error)})),c}return n(t,e),t.prototype.update=function(e){var t,n;this.options=o(o({},this.options),e),null===(n=null===(t=this.iframe)||void 0===t?void 0:t.contentWindow)||void 0===n||n.postMessage({code:"update",options:o({},e)},this.gatewayUrl)},t.prototype.success=function(e){var t,n=new CustomEvent("onSuccess",{detail:{type:be,intent:e},bubbles:!0,composed:!0});window.document.dispatchEvent(n),null===(t=this.domElement)||void 0===t||t.dispatchEvent(n)},t.prototype.fail=function(e){var t,n=new CustomEvent("onError",{detail:{type:be,error:e},bubbles:!0,composed:!0});window.document.dispatchEvent(n),null===(t=this.domElement)||void 0===t||t.dispatchEvent(n)},t}(T),Ce="wechat",Se=function(e){function t(t,n,i){var a,r,l,d,s,c=this;return(c=e.call(this,t,i)||this).elementType=Ce,null===(a=c.iframe)||void 0===a||a.setAttribute("src","".concat(t,"/#/elements/wechat?options=").concat(encodeURIComponent(JSON.stringify(o(o({},c.options),{sessionId:n,fonts:null===(r=Be.options)||void 0===r?void 0:r.fonts}))),"&lang=").concat(null===(l=Be.options)||void 0===l?void 0:l.locale)),null===(d=c.iframe)||void 0===d||d.setAttribute("name","Airwallex wechat element iframe"),null===(s=c.iframe)||void 0===s||s.setAttribute("title","Airwallex wechat element iframe"),c.addResizeListener(Ce),window.addEventListener("message",(function(e){var t,n,o,i,a,r,l,d;if(e.origin===c.gatewayUrl&&e.isTrusted&&(null===(t=e.data)||void 0===t?void 0:t.type)===Ce)if("onRedirect"===(null===(n=e.data)||void 0===n?void 0:n.code)){var s=(null!==(i=null===(o=e.data)||void 0===o?void 0:o.redirectPayload)&&void 0!==i?i:{}).redirectUrl;s&&(window.location.href=s)}else"onSuccess"===(null===(a=e.data)||void 0===a?void 0:a.code)?c.success(null===(r=e.data)||void 0===r?void 0:r.intent):"onError"===(null===(l=e.data)||void 0===l?void 0:l.code)?c.fail(e.data.error):"onReady"===(null===(d=e.data)||void 0===d?void 0:d.code)&&c.ready()})),c}return n(t,e),t.prototype.success=function(e){var t,n=new CustomEvent("onSuccess",{detail:{type:Ce,intent:e},bubbles:!0,composed:!0});window.document.dispatchEvent(n),null===(t=this.domElement)||void 0===t||t.dispatchEvent(n)},t.prototype.fail=function(e){var t,n=new CustomEvent("onError",{detail:{type:Ce,error:e},bubbles:!0,composed:!0});window.document.dispatchEvent(n),null===(t=this.domElement)||void 0===t||t.dispatchEvent(n)},t.prototype.ready=function(){var e,t=new CustomEvent("onReady",{detail:{type:Ce},bubbles:!1,composed:!0});null===(e=this.domElement)||void 0===e||e.dispatchEvent(t)},t}(T),Ie="qrcode",Ae=function(e){function t(t,n,i){var a,r,l,d,s,c=this;return(c=e.call(this,t,i)||this).elementType=Ie,null===(a=c.iframe)||void 0===a||a.setAttribute("src","".concat(t,"/#/elements/qrcode?options=").concat(encodeURIComponent(JSON.stringify(o(o({},c.options),{sessionId:n,fonts:null===(r=Be.options)||void 0===r?void 0:r.fonts}))),"&lang=").concat(null===(l=Be.options)||void 0===l?void 0:l.locale)),null===(d=c.iframe)||void 0===d||d.setAttribute("name","Airwallex qrcode element iframe"),null===(s=c.iframe)||void 0===s||s.setAttribute("title","Airwallex qrcode element iframe"),c.addResizeListener(Ie),window.addEventListener("message",(function(e){var t,n,o,i,a,r,l;if(e.origin===c.gatewayUrl&&e.isTrusted&&(null===(t=e.data)||void 0===t?void 0:t.type)===Ie)if("onSuccess"===(null===(n=e.data)||void 0===n?void 0:n.code))c.success(null===(o=e.data)||void 0===o?void 0:o.intent);else if("onError"===(null===(i=e.data)||void 0===i?void 0:i.code))c.fail(e.data.error);else if("onRedirect"===(null===(a=e.data)||void 0===a?void 0:a.code)){var d=(null!==(l=null===(r=e.data)||void 0===r?void 0:r.redirectPayload)&&void 0!==l?l:{}).redirectUrl;d&&(window.location.href=d)}})),c}return n(t,e),t.prototype.success=function(e){var t,n=new CustomEvent("onSuccess",{detail:{type:Ie,intent:e},bubbles:!0,composed:!0});window.document.dispatchEvent(n),null===(t=this.domElement)||void 0===t||t.dispatchEvent(n)},t.prototype.fail=function(e){var t,n=new CustomEvent("onError",{detail:{type:Ie,error:e},bubbles:!0,composed:!0});window.document.dispatchEvent(n),null===(t=this.domElement)||void 0===t||t.dispatchEvent(n)},t}(T),xe="redirect",Ue=function(e){function t(t,n,i){var a,r,l,d,s,c=this;return(c=e.call(this,t,i)||this).elementType=xe,null===(a=c.iframe)||void 0===a||a.setAttribute("src","".concat(t,"/#/elements/redirect?options=").concat(encodeURIComponent(JSON.stringify(o(o({},c.options),{sessionId:n,fonts:null===(r=Be.options)||void 0===r?void 0:r.fonts}))),"&lang=").concat(null===(l=Be.options)||void 0===l?void 0:l.locale)),null===(d=c.iframe)||void 0===d||d.setAttribute("name","Airwallex redirect element iframe"),null===(s=c.iframe)||void 0===s||s.setAttribute("title","Airwallex redirect element iframe"),c.addResizeListener("redirect"),window.addEventListener("message",(function(e){var t,n,o,a,r,l,d,s;if(e.origin===c.gatewayUrl&&e.isTrusted&&(null===(t=e.data)||void 0===t?void 0:t.type)===xe)if("onRedirect"===(null===(n=e.data)||void 0===n?void 0:n.code)){var u=null!==(a=null===(o=e.data)||void 0===o?void 0:o.redirectPayload)&&void 0!==a?a:{},v=u.redirectUrl,p=u.method,m=u.formData;p===(null==i?void 0:i.method)&&(m?function(e,t){var n=document.createElement("form");n.setAttribute("method","post"),n.setAttribute("style","height: 0; overflow: hidden;"),n.action=t,Object.keys(e||{}).forEach((function(t){var o=document.createElement("input");o.type="hidden",o.name=t,o.value=e[t],n.appendChild(o)}));var o=document.createElement("input");o.type="submit",n.appendChild(o),document.body.appendChild(n),o.click()}(m,v):ve(v))}else"onError"===(null===(r=e.data)||void 0===r?void 0:r.code)?c.fail(e.data.error):"onSuccess"===(null===(l=e.data)||void 0===l?void 0:l.code)&&c.success(null===(d=e.data)||void 0===d?void 0:d.intent,null===(s=e.data)||void 0===s?void 0:s.consent)})),c}return n(t,e),t.prototype.fail=function(e){var t,n=new CustomEvent("onError",{detail:{type:"redirect",error:e},bubbles:!0,composed:!0});null===(t=this.domElement)||void 0===t||t.dispatchEvent(n),window.document.dispatchEvent(n)},t.prototype.success=function(e,t){var n,o=new CustomEvent("onSuccess",{detail:{type:"redirect",intent:e,consent:t},bubbles:!0,composed:!0});window.document.dispatchEvent(o),null===(n=this.domElement)||void 0===n||n.dispatchEvent(o)},t}(T),Pe="Airwallex direct debit element iframe",Re="directDebit",_e=function(e){function t(t,n){var i,a,r,l,d,s=this;return(s=e.call(this,t,n)||this).confirmIntent={resolver:null,reject:null,awaiting:!1},s.paymentConsent={resolver:null,reject:null,awaiting:!1},null===(i=s.iframe)||void 0===i||i.setAttribute("src","".concat(t,"/#/elements/direct-debit?options=").concat(encodeURIComponent(JSON.stringify(o(o({},s.options),{fonts:null===(a=Be.options)||void 0===a?void 0:a.fonts}))),"&lang=").concat(null===(r=Be.options)||void 0===r?void 0:r.locale)),null===(l=s.iframe)||void 0===l||l.setAttribute("name",Pe),null===(d=s.iframe)||void 0===d||d.setAttribute("title",Pe),s.addResizeListener(Re),window.addEventListener("message",(function(e){var t,n;if(e.origin===s.gatewayUrl&&e.isTrusted&&(null===(t=e.data)||void 0===t?void 0:t.type)===Re)switch(e.data.code){case"onSuccess":s.success(e.data.intent,e.data.consent);break;case"onPendingVerifyAccount":s.pendingVerifyAccount(e.data.intent,null===(n=e.data.directDebit)||void 0===n?void 0:n.url);break;case"onError":s.fail(e.data.error);break;case"onChange":s.change(e.data.complete)}})),s}return n(t,e),t.prototype.change=function(e){var t,n=new CustomEvent("onChange",{detail:{type:Re,complete:e},bubbles:!0,composed:!0});window.document.dispatchEvent(n),null===(t=this.domElement)||void 0===t||t.dispatchEvent(n)},t.prototype.confirm=function(e){var t,n;return a(this,void 0,void 0,(function(){var o,a=this;return r(this,(function(r){return this.confirmIntent.awaiting?(console.warn("Should waiting previous confirm finished before execute new one!"),[2,null]):(o=i(null!=e?e:{},["element"]),null===(n=null===(t=this.iframe)||void 0===t?void 0:t.contentWindow)||void 0===n||n.postMessage({code:"confirm",data:o},this.gatewayUrl),[2,new Promise((function(e,t){a.confirmIntent.resolver=e,a.confirmIntent.reject=t,a.confirmIntent.awaiting=!0}))])}))}))},t.prototype.createPaymentConsent=function(e){var t,n;return a(this,void 0,void 0,(function(){var o,a=this;return r(this,(function(r){return this.paymentConsent.awaiting?(console.warn("Should waiting previous createPaymentConsent finished before execute new one!"),[2,null]):(o=i(e,["element"]),null===(n=null===(t=this.iframe)||void 0===t?void 0:t.contentWindow)||void 0===n||n.postMessage({code:"createPaymentConsent",data:o},this.gatewayUrl),[2,new Promise((function(e,t){a.paymentConsent.resolver=e,a.paymentConsent.reject=t,a.paymentConsent.awaiting=!0}))])}))}))},t.prototype.success=function(e,t){this.confirmIntent.awaiting&&this.confirmIntent.resolver&&e&&this.confirmIntent.resolver(e),this.paymentConsent.awaiting&&this.paymentConsent.resolver&&(e||t)&&(e?this.paymentConsent.resolver(function(e){var t=e.payment_consent_id,n=e.id,o=e.customer_id,i=e.currency;return{intent_id:n,payment_consent_id:null!=t?t:"",customer_id:null!=o?o:"",currency:null!=i?i:""}}(e)):t&&this.paymentConsent.resolver({payment_consent_id:t.id,customer_id:t.customer_id})),this.confirmIntent.awaiting=!1,this.paymentConsent.awaiting=!1},t.prototype.fail=function(e){this.confirmIntent.awaiting&&this.confirmIntent.reject&&this.confirmIntent.reject(e),this.paymentConsent.awaiting&&this.paymentConsent.reject&&this.paymentConsent.reject(e),this.confirmIntent.awaiting=!1,this.paymentConsent.awaiting=!1},t.prototype.pendingVerifyAccount=function(e,t){var n,o=new CustomEvent("onPendingVerifyAccount",{detail:{type:Re,intent:e,url:t},bubbles:!0,composed:!0});null===(n=this.domElement)||void 0===n||n.dispatchEvent(o)},t}(T),Me=function(e){return(e||"").includes("://")?encodeURIComponent(e):encodeURIComponent("https://".concat(e))},Te=function(e){return"string"==typeof e},ke=function(e){return"boolean"==typeof e},je=function(e){return"string"==typeof e},Le=function(e){return"object"==typeof e&&null!==e},We={intent_id:{validate:Te,format:function(e){return"".concat(e)}},client_secret:{validate:Te,format:function(e){return"".concat(e)}},theme:{validate:Le,format:function(e){return encodeURIComponent(JSON.stringify(e))}},customer_id:{validate:Te,format:function(e){return"".concat(e)}},components:{validate:Le,format:function(e){return encodeURIComponent(JSON.stringify(e))}},methods:{validate:Le,format:function(e){return encodeURIComponent(JSON.stringify(e))}},autoCapture:{validate:ke,format:function(e){return"".concat(e)}},successUrl:{validate:je,format:function(e){return Me("".concat(e))}},failUrl:{validate:je,format:function(e){return Me("".concat(e))}},cancelUrl:{validate:je,format:function(e){return Me("".concat(e))}},logoUrl:{validate:je,format:function(e){return Me("".concat(e))}},locale:{validate:Te,format:function(e){return"".concat(e)}},withBilling:{validate:ke,format:function(e){return"".concat(e)}},mode:{validate:Te,format:function(e){return"".concat(e)}},applePayRequestOptions:{validate:Le,format:function(e){return encodeURIComponent(JSON.stringify(e))}},googlePayRequestOptions:{validate:Le,format:function(e){return encodeURIComponent(JSON.stringify(e))}},requiredBillingContactFields:{validate:Le,format:function(e){return encodeURIComponent(JSON.stringify(e))}},recurringOptions:{validate:Le,format:function(e){return encodeURIComponent(JSON.stringify(e))}},currency:{validate:Te,format:function(e){return"".concat(e)}},country_code:{validate:Te,format:function(e){return"".concat(e)}},shopper_name:{validate:Te,format:function(e){return"".concat(e)}},shopper_phone:{validate:Te,format:function(e){return"".concat(e)}},shopper_email:{validate:Te,format:function(e){return"".concat(e)}},showTermLink:{validate:ke,format:function(e){return"".concat(e)}}},Ne="googlePayButton",Oe=function(e){function t(t,n,i){var a,r,l,d,s,c=this;(c=e.call(this,t,i)||this).elementType=Ne;var u=c.options,v=u.amount,p=u.client_secret,m=u.countryCode;v&&p&&m?(null===(a=c.iframe)||void 0===a||a.setAttribute("src","".concat(t,"/#/elements/google-pay?options=").concat(encodeURIComponent(JSON.stringify(o(o({},c.options),{sessionId:n,fonts:null===(r=Be.options)||void 0===r?void 0:r.fonts}))),"&lang=").concat(null===(l=Be.options)||void 0===l?void 0:l.locale)),null===(d=c.iframe)||void 0===d||d.setAttribute("name","Airwallex google pay button iframe"),null===(s=c.iframe)||void 0===s||s.setAttribute("title","Airwallex google pay button iframe")):(console.warn("please check the required options of google pay button element"),c.ready()),c.addResizeListener(Ne);var f=function(e){var t,n,o,a,r,l,d,s,u;try{if(e.origin===c.gatewayUrl&&e.isTrusted&&(null===(t=e.data)||void 0===t?void 0:t.type)===Ne)switch(null===(n=e.data)||void 0===n?void 0:n.code){case"onReady":te({type:Ne,popupWidth:null===(o=null==i?void 0:i.style)||void 0===o?void 0:o.popupWidth,popupHeight:null===(a=null==i?void 0:i.style)||void 0===a?void 0:a.popupHeight,authFormContainer:null==i?void 0:i.authFormContainer,lang:null===(r=null==Be?void 0:Be.options)||void 0===r?void 0:r.locale}),c.ready();break;case"onSuccess":c.success(null===(l=e.data)||void 0===l?void 0:l.intent,null===(d=e.data)||void 0===d?void 0:d.consent);break;case"onGooglePayButtonClick":c.click();break;case"onCancel":c.cancel(null===(s=e.data)||void 0===s?void 0:s.intent);break;case"onError":c.fail(null===(u=e.data)||void 0===u?void 0:u.error)}}catch(e){console.error(e)}};return window.addEventListener("popstate",(function(){window.removeEventListener("message",f)})),window.addEventListener("message",f),c}return n(t,e),t.prototype.click=function(){var e,t=new CustomEvent("onClick",{detail:{type:Ne},bubbles:!0,composed:!0});null===(e=this.domElement)||void 0===e||e.dispatchEvent(t)},t.prototype.ready=function(){var e,t=new CustomEvent("onReady",{detail:{type:Ne},bubbles:!0,composed:!0});null===(e=this.domElement)||void 0===e||e.dispatchEvent(t)},t.prototype.cancel=function(e){var t,n=new CustomEvent("onCancel",{detail:{type:Ne,intent:e},bubbles:!0,composed:!0});null===(t=this.domElement)||void 0===t||t.dispatchEvent(n)},t.prototype.success=function(e,t){var n,o=new CustomEvent("onSuccess",{detail:{type:Ne,intent:e,consent:t},bubbles:!0,composed:!0});null===(n=this.domElement)||void 0===n||n.dispatchEvent(o)},t.prototype.fail=function(e){var t,n=new CustomEvent("onError",{detail:{type:Ne,error:e},bubbles:!0,composed:!0});null===(t=this.domElement)||void 0===t||t.dispatchEvent(n)},t}(T),Fe=["cardNumber","expiry","cvc","paymentRequestButton","card","wechat","qrcode","redirect","dropIn","fullFeaturedCard","applePayButton","googlePayButton","directDebit"],De=l(l([],Fe,!0),["threeDsFrictionless","threeDsChallenge"],!0),Be={gatewayUrl:"",options:{}},qe={cardNumber:null,expiry:null,cvc:null,threeDsFrictionless:null,threeDsChallenge:null,paymentRequestButton:null,card:null,wechat:null,qrcode:null,redirect:null,dropIn:null,fullFeaturedCard:null,applePayButton:null},ze=function(e){var t,n;return M({env:null===(t=Be.options)||void 0===t?void 0:t.env,eventName:R,method:"destroyElement",type:e}),De.includes(e)?(null===(n=qe[e])||void 0===n||n.destroy(),qe[e]=null,!0):(console.warn("destroyElement with type: ".concat(e," not support!")),!1)},He=function(e){return De.includes(e)?qe[e]:(console.warn("getElement with type: ".concat(e," not support!")),null)},Je=function(e,t){var n;return M({env:null===(n=Be.options)||void 0===n?void 0:n.env,eventName:R,method:"setElement",type:e,element:t}),De.includes(e)?(qe[e]=t,!0):(console.warn("destroyElement with type: ".concat(e," not support!")),!1)};return e.confirmPaymentIntent=function(e){return a(void 0,void 0,void 0,(function(){var t;return r(this,(function(n){return console.info("Confirm intent ".concat((null==e?void 0:e.intent_id)||(null==e?void 0:e.id)," with client secret: ").concat(null==e?void 0:e.client_secret)),M(o({env:null===(t=Be.options)||void 0===t?void 0:t.env,eventName:R,method:"confirmPaymentIntent"},e)),(null==e?void 0:e.element)?[2,(null==e?void 0:e.element).confirm(e)]:(console.warn("Card number element must be provided for card payment confirm!"),[2,!1])}))}))},e.confirmPaymentIntentWithSavedCard=function(e){return a(void 0,void 0,void 0,(function(){var t;return r(this,(function(n){return console.info("Confirm intent ".concat((null==e?void 0:e.intent_id)||(null==e?void 0:e.id)," with client secret: ").concat(null==e?void 0:e.client_secret)),M(o({env:null===(t=Be.options)||void 0===t?void 0:t.env,eventName:R,method:"confirmPaymentIntentWithSavedCard"},e)),(null==e?void 0:e.element)&&(null==e?void 0:e.methodId)?[2,(null==e?void 0:e.element).confirm(e)]:(console.warn("Payment method id must be provided for cvc payment confirm!"),[2,!1])}))}))},e.createElement=function(e,t){var n,o=null!=t?t:{origin:""};return o.origin=o.origin||(null===(n=Be.options)||void 0===n?void 0:n.origin),Fe.includes(e)?"cardNumber"===e?(qe[e]=new re(Be.gatewayUrl,P.sessionId,o),qe[e]):"card"===e?(qe[e]=new ie(Be.gatewayUrl,P.sessionId,o),qe[e]):"fullFeaturedCard"===e?(qe[e]=new Ee(Be.gatewayUrl,P.sessionId,o),qe[e]):"wechat"===e?(qe[e]=new Se(Be.gatewayUrl,P.sessionId,o),qe[e]):"qrcode"===e?(qe[e]=new Ae(Be.gatewayUrl,P.sessionId,o),qe[e]):"redirect"===e?(qe[e]=new Ue(Be.gatewayUrl,P.sessionId,o),qe[e]):"applePayButton"===e?(qe[e]=new L(Be.gatewayUrl,P.sessionId,o),qe[e]):"googlePayButton"===e?(qe[e]=new Oe(Be.gatewayUrl,P.sessionId,o),qe[e]):"paymentRequestButton"===e?(qe[e]=new ue(Be.gatewayUrl,P.sessionId,o),qe[e]):"dropIn"===e?(qe[e]=new ge(Be.gatewayUrl,P.sessionId,o),qe[e]):"expiry"===e||"cvc"===e?(qe[e]="expiry"===e?new de(Be.gatewayUrl,P.sessionId,o):new ce(Be.gatewayUrl,P.sessionId,o),window.addEventListener("message",(function(t){var n,o,i,a,r,l;t.origin===Be.gatewayUrl&&t.isTrusted&&e===(null===(n=t.data)||void 0===n?void 0:n.type)&&"onChange"===(null===(o=t.data)||void 0===o?void 0:o.code)&&(null===(r=null===(a=null===(i=qe.cardNumber)||void 0===i?void 0:i.iframe)||void 0===a?void 0:a.contentWindow)||void 0===r||r.postMessage({code:"update_".concat(null===(l=t.data)||void 0===l?void 0:l.type),data:t.data},Be.gatewayUrl))})),qe[e]):"directDebit"===e?(qe[e]=new _e(Be.gatewayUrl,o),qe[e]):null:(console.warn("createElement with type: ".concat(e," not support!")),null)},e.createPaymentConsent=function(e){return a(void 0,void 0,void 0,(function(){var t;return r(this,(function(n){return console.info("Create payment consent with client secret: ".concat(e.client_secret)),M(o({env:null===(t=Be.options)||void 0===t?void 0:t.env,eventName:R,method:"createPaymentConsent"},e)),(null==e?void 0:e.element)?[2,(null==e?void 0:e.element).createPaymentConsent(e)]:(console.warn("Either payment method id or element must be provided for create payment consent!"),[2,!1])}))}))},e.createPaymentMethod=function(e,t){return a(void 0,void 0,void 0,(function(){var n;return r(this,(function(i){return console.info("Create payment method with client secret: ".concat(e)),M(o({env:null===(n=Be.options)||void 0===n?void 0:n.env,eventName:R,method:"createPaymentMethod"},t)),(null==t?void 0:t.element)?[2,(null==t?void 0:t.element).createPaymentMethod(o(o({},t),{client_secret:e}))]:(console.warn("Either payment method id or element must be provided for payment method create!"),[2,!1])}))}))},e.createPlaidPopupIframe=fe,e.destroyElement=ze,e.get3dsReturnUrl=function(e){var t=e.env,n=e.checkoutOrigin;return M(o({env:t,eventName:R,method:"get3dsReturnUrl"},e)),"".concat(S[t||"prod"],"/api/v1/checkout/elements/3ds?origin=https://").concat(C[t||"prod"],"&checkoutOrigin=").concat(n||window.location.origin,"&componentName=api")},e.getBrowserInfo=function(e){var t=e||{},n=t.intent_id,i=t.env;M(o({env:i,eventName:R,method:"getBrowserInfo"},e));var a,r=window||{},l=r.navigator,d=r.screen,s=(l||{}).language,c=d||{},u=c.colorDepth,v=c.height,p=c.width;return e&&(a=D({intent_id:n,env:i})),{device_id:a,screen_height:v,screen_width:p,screen_color_depth:u,language:s,timezone:(new Date).getTimezoneOffset(),browser:{java_enabled:window.navigator.javaEnabled(),javascript_enabled:!0,user_agent:l.userAgent}}},e.getDeviceFingerprint=D,e.getElement=He,e.getPaymentIntent=function(e,t){return a(void 0,void 0,void 0,(function(){var n,o;return r(this,(function(i){return M({env:null===(n=Be.options)||void 0===n?void 0:n.env,eventName:R,method:"getPaymentIntent",id:e}),[2,(null===(o=qe.cardNumber)||void 0===o?void 0:o.getPaymentIntent(e,t))||!1]}))}))},e.handle3ds=function(e){var t=e.next_action,n=e.authFormContainer,i=e.intent,a=e.challengeWindowSize,r=e.env;return M(o({eventName:R,method:"handle3ds"},e)),ee({gatewayUrl:"https://".concat(C[r]),intent:i,next_action:t,authFormContainer:n,componentType:"api",challengeWindowSize:a})},e.handle3dsFlow=te,e.init=function(e){!(null==e?void 0:e.env)&&Be.gatewayUrl||(Be.gatewayUrl=I((null==e?void 0:e.env)||"prod")),Be.options=e,F({orderSessionId:P.sessionId,env:(null==e?void 0:e.env)||"prod"})},e.postMessageToPlaidIframe=he,e.redirectToCheckout=function(e){var t;M(o({env:null===(t=Be.options)||void 0===t?void 0:t.env,eventName:R,method:"redirectToCheckout"},e));var n=e.env,a=e.disableAutoRedirect,r=function(e){var t={};return Object.keys(We).forEach((function(n){var o=e[n];null!==o&&""!==o&&We[n].validate(o)&&(t[n]=We[n].format(o))})),t}(i(e,["env","disableAutoRedirect"])),l=r||{},d=l.id,s=i(l,["id"]),c=Object.keys(s),u=[];c.forEach((function(e){u.push("".concat(e,"=").concat(s[e]))})),u.push("from=".concat(window.location.origin)),u.push("sessionId=".concat(P.sessionId));var v="recurring"===e.mode?"".concat(I(n||"prod"),"/#/standalone/recurring?").concat(u.join("&")):"".concat(I(n||"prod"),"/#/standalone/checkout/").concat(d||(null==s?void 0:s.intent_id),"?").concat(u.join("&"));if(a)return v;window.location.href=v},Object.defineProperty(e,"__esModule",{value:!0}),e}({});